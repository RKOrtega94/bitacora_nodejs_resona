extends layout

block content
  // Page Wrapper
  #wrapper
    include helpers/sidebar
    // Content Wrapper
    #content-wrapper.d-flex.flex-column
      // Main Content
      #content
        include helpers/topbar
        // Begin Page Content
        .container-fluid
          // DataTales Example
          .card.shadow.mb-4
            .card-header.py-3
              h6.m-0.font-weight-bold.text-primary Registro general
            .card-body
              .table-responsive
                table#dataTable.table.table-bordered(width='100%' cellspacing='0')
                  thead
                    tr
                      th Fecha
                      th Anillamador
                      th Identification
                      th PIR
                      th Ticket
                      th Time
                  tfoot
                    tr
                      th Fecha
                      th Anillamador
                      th Identification
                      th PIR
                      th Ticket
                      th Time
                  tbody
        // End of Main Content
        // Footer
        br
        footer.sticky-footer.bg-white
          .container.my-auto
            .copyright.text-center.my-auto
              span Copyright Â© RESONATELECOM S.A. 2019
          br
          .container.my-auto
            .copyright.text-center.my-auto
              span Developed by RKOrtega
        // End of Footer
        // End of Content Wrapper
        // End of Page Wrapper
        // Scroll to Top Button
        a.scroll-to-top.rounded(href='#page-top')
          i.fas.fa-angle-up
        include helpers/logout
  // The core Firebase JS SDK is always required and must be listed first
  script(src='https://www.gstatic.com/firebasejs/6.6.2/firebase-app.js')
  // Add Firebase products that you want to use
  script(src='https://www.gstatic.com/firebasejs/5.10.1/firebase-database.js')
  script.
    //Define variables
    var user = "!{result}";
    var result = [];
    //Firebase Config
    var firebaseConfig = {
    apiKey: "AIzaSyBe7C2-8lUMP1KWPJ_-lkvKzu0ytl5fAME",
    authDomain: "resonatel.firebaseapp.com",
    databaseURL: "https://resonatel.firebaseio.com",
    projectId: "resonatel",
    storageBucket: "resonatel.appspot.com",
    messagingSenderId: "710009860039",
    appId: "1:710009860039:web:54d43ee0d8b8a4733ab3e2"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    // Get reference
    var query = firebase.database().ref("tickets/"+user)
    function addRow(data){
      var table = $('#dataTable').DataTable();
      table.row.add([
        data.date,
        data.anillamador,
        data.dni,
        data.pir,
        data.ticket,
        data.tmo
      ]).draw(true);
    }
    // Query database
    query.once('value', snapshot => {
    snapshot.forEach(childSnapshot => {
    result = childSnapshot.val()
      addRow(result)
    })
    })